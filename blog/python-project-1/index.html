<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Python Project (1) setup.py setup.cfg | Lambda</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Create Your Own Python Project"><meta name=generator content="Hugo 0.104.3"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Python Project (1) setup.py setup.cfg"><meta property="og:description" content="Create Your Own Python Project"><meta property="og:type" content="article"><meta property="og:url" content="/blog/python-project-1/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-04-22T00:00:00+00:00"><meta property="article:modified_time" content="2021-04-22T00:00:00+00:00"><meta itemprop=name content="Python Project (1) setup.py setup.cfg"><meta itemprop=description content="Create Your Own Python Project"><meta itemprop=datePublished content="2021-04-22T00:00:00+00:00"><meta itemprop=dateModified content="2021-04-22T00:00:00+00:00"><meta itemprop=wordCount content="173"><meta itemprop=keywords content="python,project,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Python Project (1) setup.py setup.cfg"><meta name=twitter:description content="Create Your Own Python Project"></head><body class="ma0 avenir bg-near-white"><header><div class=bg-black><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib">Lambda</a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/ title="Home page">Home</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/blog/ title="Blog page">Blog</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/categories/ title="Categories page">Categories</a></li></ul><div class=ananke-socials></div></div></div></nav></div></header><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">BLOG</aside><div id=sharing class="mt3 ananke-socials"></div><h1 class="f1 athelas mt3 mb1">Python Project (1) setup.py setup.cfg</h1><p class=tracked>By <strong><a href=mailto:lambda@lambda.tw>lambda@lambda.tw</a></strong></p><time class="f6 mv4 dib tracked" datetime=2021-04-22T00:00:00Z>April 22, 2021</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><h1 id=create-project>Create Project</h1><p>開專案一直以來都不是一個簡單的事情，專案開的好可以讓後面的開發更有效率，團隊也可以有比較一致開發準則，接下來幾篇文章會大該說說之前研究開 Python 專案的一些經驗</p><h2 id=create-setuppy-for-install>Create <code>setup.py</code> For Install</h2><p>如果專案要可以被安裝，就需要寫這檔案，裡面可寫詳述該套件需要裝哪些東西，以及一些資訊，建議放在專案的根目錄，這樣別人就可以直接用你的 Git Repo 去安裝你的套件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> setuptools <span style=color:#f92672>import</span> find_packages, setup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>REPO_URL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://github.com/lambdaTW/python-project&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_version</span>(rel_path):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> Path(rel_path)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>splitlines():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;__version__&#34;</span>):
</span></span><span style=display:flex><span>            delim <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#f92672>in</span> line <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> line<span style=color:#f92672>.</span>split(delim)[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#34;Unable to find version string.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setup(
</span></span><span style=display:flex><span>    name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;python-project&#34;</span>,
</span></span><span style=display:flex><span>    version<span style=color:#f92672>=</span>get_version(<span style=color:#e6db74>&#34;src/python-project/__init__.py&#34;</span>),
</span></span><span style=display:flex><span>    description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;My python project&#34;</span>,
</span></span><span style=display:flex><span>    long_description<span style=color:#f92672>=</span>Path(<span style=color:#e6db74>&#34;README.md&#34;</span>)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read(),
</span></span><span style=display:flex><span>    long_description_content_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/markdown&#34;</span>,
</span></span><span style=display:flex><span>    python_requires<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&gt;=3.8&#34;</span>,
</span></span><span style=display:flex><span>    classifiers<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Programming Language :: Python :: 3.8&#34;</span>,
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    keywords<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;python&#34;</span>, <span style=color:#e6db74>&#34;project&#34;</span>],
</span></span><span style=display:flex><span>    url<span style=color:#f92672>=</span>REPO_URL,
</span></span><span style=display:flex><span>    author<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lambdaTW&#34;</span>,
</span></span><span style=display:flex><span>    author_email<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lambda@lambda.tw&#34;</span>,
</span></span><span style=display:flex><span>    license<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;MIT&#34;</span>,
</span></span><span style=display:flex><span>    packages<span style=color:#f92672>=</span>find_packages(where<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;src&#34;</span>, exclude<span style=color:#f92672>=</span>(<span style=color:#e6db74>&#34;test*&#34;</span>,)),
</span></span><span style=display:flex><span>    package_dir<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;&#34;</span>: <span style=color:#e6db74>&#34;src&#34;</span>},
</span></span><span style=display:flex><span>    <span style=color:#75715e># namespace_packages=[&#34;lambdatw&#34;],</span>
</span></span><span style=display:flex><span>    install_requires<span style=color:#f92672>=</span>Path(<span style=color:#e6db74>&#34;requirements/base.in&#34;</span>)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>splitlines(),
</span></span><span style=display:flex><span>    include_package_data<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    zip_safe<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=create-setupcfg>Create <code>setup.cfg</code></h2><p><code>setup.cfg</code> 原本是拿來做 <code>setup.py</code> 的設定檔，但是很多 Python 相關的 Library 也把它當作設定檔，所以除了可以替代 setup.py 的設定也可以用來設定很多東西</p><h3 id=for-install>For Install</h3><p>如果你不想寫很多東西在 <code>setup.py</code> 像是 <a href=https://github.com/pytest-dev/pytest>pytest</a> 的 <code>setup.py</code> 就十分乾淨只有以下幾行，其他都寫在其 <a href=https://github.com/pytest-dev/pytest/blob/main/setup.cfg><code>setup.cfg</code></a>，由於是設定檔一樣大部分都放根目錄</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># setup.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> setuptools <span style=color:#f92672>import</span> setup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    setup()
</span></span></code></pre></div><p>下面可以看到 <code>setup.cfg</code> 在 <code>metadata</code>、<code>options</code> 的部分就是 <code>setup.py</code> 的參數</p><pre tabindex=0><code># setup.cfg
[metadata]
name = pytest
description = pytest: simple powerful testing with Python
long_description = file: README.rst
long_description_content_type = text/x-rst
# ... more than 100 lines
</code></pre><h3 id=for-setting>For Setting</h3><p>由於很多套件都會使用 <code>setup.cfg</code> 當作他的設定檔，只要設定相對應的名稱在 <code>[ ]</code> 中，就可以使用，至於要設定什麼，就要依照該套件的說明去看，例如：<code>mypy</code> 這套件是用來做型別靜態檢查的，我們就可以在 <code>setup.cfg</code> 設定他的參數如下</p><pre tabindex=0><code># setup.cfg
[mypy]
follow_imports = silent
show_column_numbers = true
ignore_missing_imports = true
</code></pre><ul class=pa0><li class="list di"><a href=/tags/python/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">python</a></li><li class="list di"><a href=/tags/project/ class="link f5 grow no-underline br-pill ba ph3 pv2 mb2 dib black sans-serif">project</a></li></ul><div class="mt6 instapaper_ignoref"><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//blog-khfo0axv59.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/blog/closure/>Closure</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=/>&copy; Lambda 2022</a><div><div class=ananke-socials></div></div></div></footer></body></html>