<!doctype html><html lang=en><head><title>Python Project (1) setup.py setup.cfg :: Lambda</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Create Your Own Python Project"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/blog/python-project-1/><link rel=stylesheet href=/style.css><link rel="shortcut icon" href=/img/theme-colors/orange.png><link rel=apple-touch-icon href=/img/theme-colors/orange.png><meta name=twitter:card content="summary"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Python Project (1) setup.py setup.cfg"><meta property="og:description" content="Create Your Own Python Project"><meta property="og:url" content="/blog/python-project-1/"><meta property="og:site_name" content="Lambda"><meta property="og:image" content="img/favicon/%!s().png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><meta property="article:section" content="python"><meta property="article:section" content="project"><meta property="article:published_time" content="2021-04-22 00:00:00 +0000 UTC"></head><body><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Lambda</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/blog/>Blog</a></li><li><a href=/categories/>Categories</a></li><li><a href=/about>About</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/blog/>Blog</a></li><li><a href=/categories/>Categories</a></li><li><a href=/about>About</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=/blog/python-project-1/>Python Project (1) setup.py setup.cfg</a></h1><div class=post-meta><time class=post-date>2021-04-22 ::</time>
<span class=post-author>lambda@lambda.tw</span></div><span class=post-tags>#<a href=/tags/python/>python</a>&nbsp;
#<a href=/tags/project/>project</a>&nbsp;</span><div class=post-content><div><h1 id=create-project>Create Project<a href=#create-project class=hanchor arialabel=Anchor>&#8983;</a></h1><p>開專案一直以來都不是一個簡單的事情，專案開的好可以讓後面的開發更有效率，團隊也可以有比較一致開發準則，接下來幾篇文章會大該說說之前研究開 Python 專案的一些經驗</p><h2 id=create-setuppy-for-install>Create <code>setup.py</code> For Install<a href=#create-setuppy-for-install class=hanchor arialabel=Anchor>&#8983;</a></h2><p>如果專案要可以被安裝，就需要寫這檔案，裡面可寫詳述該套件需要裝哪些東西，以及一些資訊，建議放在專案的根目錄，這樣別人就可以直接用你的 Git Repo 去安裝你的套件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pathlib <span style=color:#f92672>import</span> Path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> setuptools <span style=color:#f92672>import</span> find_packages, setup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>REPO_URL <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://github.com/lambdaTW/python-project&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_version</span>(rel_path):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> Path(rel_path)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>splitlines():
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line<span style=color:#f92672>.</span>startswith(<span style=color:#e6db74>&#34;__version__&#34;</span>):
</span></span><span style=display:flex><span>            delim <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;&#34;&#39;</span> <span style=color:#f92672>in</span> line <span style=color:#66d9ef>else</span> <span style=color:#e6db74>&#34;&#39;&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> line<span style=color:#f92672>.</span>split(delim)[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>RuntimeError</span>(<span style=color:#e6db74>&#34;Unable to find version string.&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>setup(
</span></span><span style=display:flex><span>    name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;python-project&#34;</span>,
</span></span><span style=display:flex><span>    version<span style=color:#f92672>=</span>get_version(<span style=color:#e6db74>&#34;src/python-project/__init__.py&#34;</span>),
</span></span><span style=display:flex><span>    description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;My python project&#34;</span>,
</span></span><span style=display:flex><span>    long_description<span style=color:#f92672>=</span>Path(<span style=color:#e6db74>&#34;README.md&#34;</span>)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read(),
</span></span><span style=display:flex><span>    long_description_content_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text/markdown&#34;</span>,
</span></span><span style=display:flex><span>    python_requires<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&gt;=3.8&#34;</span>,
</span></span><span style=display:flex><span>    classifiers<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;Programming Language :: Python :: 3.8&#34;</span>,
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    keywords<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;python&#34;</span>, <span style=color:#e6db74>&#34;project&#34;</span>],
</span></span><span style=display:flex><span>    url<span style=color:#f92672>=</span>REPO_URL,
</span></span><span style=display:flex><span>    author<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lambdaTW&#34;</span>,
</span></span><span style=display:flex><span>    author_email<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;lambda@lambda.tw&#34;</span>,
</span></span><span style=display:flex><span>    license<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;MIT&#34;</span>,
</span></span><span style=display:flex><span>    packages<span style=color:#f92672>=</span>find_packages(where<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;src&#34;</span>, exclude<span style=color:#f92672>=</span>(<span style=color:#e6db74>&#34;test*&#34;</span>,)),
</span></span><span style=display:flex><span>    package_dir<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#34;&#34;</span>: <span style=color:#e6db74>&#34;src&#34;</span>},
</span></span><span style=display:flex><span>    <span style=color:#75715e># namespace_packages=[&#34;lambdatw&#34;],</span>
</span></span><span style=display:flex><span>    install_requires<span style=color:#f92672>=</span>Path(<span style=color:#e6db74>&#34;requirements/base.in&#34;</span>)<span style=color:#f92672>.</span>open()<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>splitlines(),
</span></span><span style=display:flex><span>    include_package_data<span style=color:#f92672>=</span><span style=color:#66d9ef>True</span>,
</span></span><span style=display:flex><span>    zip_safe<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>,
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=create-setupcfg>Create <code>setup.cfg</code><a href=#create-setupcfg class=hanchor arialabel=Anchor>&#8983;</a></h2><p><code>setup.cfg</code> 原本是拿來做 <code>setup.py</code> 的設定檔，但是很多 Python 相關的 Library 也把它當作設定檔，所以除了可以替代 setup.py 的設定也可以用來設定很多東西</p><h3 id=for-install>For Install<a href=#for-install class=hanchor arialabel=Anchor>&#8983;</a></h3><p>如果你不想寫很多東西在 <code>setup.py</code> 像是 <a href=https://github.com/pytest-dev/pytest>pytest</a> 的 <code>setup.py</code> 就十分乾淨只有以下幾行，其他都寫在其 <a href=https://github.com/pytest-dev/pytest/blob/main/setup.cfg><code>setup.cfg</code></a>，由於是設定檔一樣大部分都放根目錄</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># setup.py</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> setuptools <span style=color:#f92672>import</span> setup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    setup()
</span></span></code></pre></div><p>下面可以看到 <code>setup.cfg</code> 在 <code>metadata</code>、<code>options</code> 的部分就是 <code>setup.py</code> 的參數</p><pre tabindex=0><code># setup.cfg
[metadata]
name = pytest
description = pytest: simple powerful testing with Python
long_description = file: README.rst
long_description_content_type = text/x-rst
# ... more than 100 lines
</code></pre><h3 id=for-setting>For Setting<a href=#for-setting class=hanchor arialabel=Anchor>&#8983;</a></h3><p>由於很多套件都會使用 <code>setup.cfg</code> 當作他的設定檔，只要設定相對應的名稱在 <code>[ ]</code> 中，就可以使用，至於要設定什麼，就要依照該套件的說明去看，例如：<code>mypy</code> 這套件是用來做型別靜態檢查的，我們就可以在 <code>setup.cfg</code> 設定他的參數如下</p><pre tabindex=0><code># setup.cfg
[mypy]
follow_imports = silent
show_column_numbers = true
ignore_missing_imports = true
</code></pre></div></div><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//blog-khfo0axv59.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2023 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>